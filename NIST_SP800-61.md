# NIST SP800-61 コンピュータセキュリティインシデント対応ガイド


## 重要要素

* 現在および将来にわたってもたらす業務への影響を評価するための、明確な手順を確立する
* 効果的にデータを収集、分析、報告する方法を構築、ほかの内部グループ（人事部、法務部など）や、外部グループ（ほかのインシデント対応チーム、法執行機関など）との関係を構築して、適切なコミュニケーション手段を確立する


### 組織化
* ポリシーと手順
* チーム構成（外部委託含む）
* 他組織へのインシデント対応への参加要請
    * 他部署等

### 事件処理
* 準備フェーズ
* 検出, 対応, 低減, 報告, 復旧, 改善, 教訓


### 特定種類毎の事件処理
* サービス不能(DoS)
* 悪意のコード(マルウェア)
* 不正アクセス(未許可のアクセス、Web改竄など)
* 不適切な使用(ユーザーによるルール違反など)
* 複合要素


**米政府機関は、連邦法によりUS-CERTに事件報告の義務あり。**

FISMA(連邦情報セキュリティマネジメント法)は
政府機関のインシデント対応能力の確立を義務付け。

#### インシデント対応能力の確立
* ポリシー及び計画
* ポリシーに基づき、処理と報告の実施手順を作成
* 外部組織連絡ガイドライン
* チーム構成、要因配置 ※スキルマップも必要、出来ること出来ないこと
* CSIRTと他部署等との関係を樹立
* サービスの明確化（なんでもやるのではない）
* トレーニング


#### インシデント対応リーダーの決定
* 事件処理担当者やほかの関係者から情報を収集し、情報が必要な関係者に適切な情報を配布する責任をもつ


## 権限

### 1.2 目的及び適用範囲
* セキュリティ事故の検知、分析、優先順位付けおよび処理
* 固有のセキュリティ要件や業務要件に合うように、推奨されるガイドラインや対処方法を調整することを推奨


### 1.4 ドキュメント構成
* Section2 インシデント対応の必要性、対応チームの構成、関係者
* Section3 基本的な対応処理ステップの確認、事件の検知と分析をより効果的に実施するためのアドバイス
* Section4-8 代表的なインシデントの具体的な推奨内容

*付録A インシデント対応の推奨事項*  
*付録B シナリオと、インシデント対応の訓練で使用する質問*  
*付録C 各事件で収集すべきデータフィールドの一覧*  
*付録G オンラインのツールとリソースの一覧*  
*付録G インシデント対応についてよく聞かれる質問*  
*付録I セキュリティインシデントに関連する危機に対処する際に従うべき、主なステップの一覧*  
*付録J US-CERTが提供する、インシデント報告に関する手引き*  




## コンピュータセキュリティインシデント対応能力の組織化

**まず考慮する点**
* 「事件」という用語の範囲が明確になるように、この用語に対し組織固有の定義を与える
* インシデント対応チームがどのようなサービスを提供するかを決める
* サービス提供するためにはどのチーム構成やモデルが合っているかを検討
* インシデント対応チームを実際に編成する
    * インシデント対応ポリシーと計画の作成
    * 手順の作成(外部組織とのやりとりも反映させる)


### 2.1 事象と事件

**事象とは**  
> システムまたはネットワークで識別できるあらゆる出来事
* ユーザによるファイル共有への接続
* インターネット閲覧
* メール送受信
* ファイアウォールによる接続のブロック

**有害事象とは**
> ネガティブな結果を伴う事象
* システムクラッシュ
* ネットワークパケットの氾濫
* システム特権の不正利用
* 機密データへの不正アクセス
* データを破壊する悪意のコードの実行

```このガイドでは、コンピュータセキュリティに関する有害事象だけを扱い、自然災害や停電などによる有害事象は対象としない```


**「コンピュターセキュリティインシデント」とは？**
> 組織が定めるセキュリティポリシーやコンピュータの利用規定に対する違反行為  
> または差し迫った脅威、あるいは、標準的なセキュリティ活動に対する違反行為または差し迫った脅威を示す。

* サービス不能
* 悪意のコード
* 不正アクセス
* 不適切な使用


### 2.2 インシデント対応の必要性

#### 2.3.1. ポリシーの要素
**`！！！組織ごとに非常に違ったものになる！！！`**

* マネジメント層の責任表明
* ポリシーの目的と目標
* ポリシーの範囲(だれに、何に、どのような状況で適用されるか)
* コンピュータセキュリティインシデントの定義と、それらのインシデントが自組織にもたらす結果。
* 組織構造と、役割、責任、権限レベルを表す記述
* 事件の優先順位付けまたは重大さの格付け
* 実施評価(セクション3.4.2で説明)。
* 報告フォームとコンタクトフォーム

#### 2.3.2 計画の要素

それぞれの組織は、自身のミッション、組織の規模、組織の構造、および組織の機能に見合った独自の要求事項を満たすための、計画を策定しなければならない。    
インシデント対応計画には、以下のものが含まれる。

* ミッション
* 戦略及び目標
* 上級管理職による承認
* インシデント対応への組織的な取り組み
* インシデント対応チームによる他の職員への連絡方法
* インシデント対応機能を測定するためのマトリックス
* インシデント対応機能を熟成させるための手引き
* インシデント対応計画をどのようにして組織全体に適合させるか


#### 2.3.3. 手順の要素

**標準運用手順(SOP: StandardOperating Procedures)**
* 特定の技術手順
* 手法
* チェックリスト
* フォーム

SOPはテストを行い、正確さと有用性を検証した後、チームの全メンバーに配布する  
SOPの利用者にはトレーニングを実施すべきである

#### 2.3.4. 外部の関係者との情報共有

組織は、外部の関係者に事件について連絡しなくてはならない場合がある。

**米国**
* US-CERT
* 法執行機関
* マスコミの問い合わせ
等がある。

*以下は原文には無い*
**日本**
* JP-CERT
* IPA
* 監督官庁等


**インシデント処理担当者の連絡先**
* 組織のインターネットサービス・プロバイダ(ISP)
* 攻撃者のISP
* 脆弱性があるソフトウェアのベンダー
* 発生しているインシデントに詳しいインシデント対応チームなど

事件の詳細を外部の組織に連絡したい(または連絡しなくてはならない)場合に備えて詳細に話しあっておく
* 広報部
* 法務部
* マネジメント層など

情報共有に関するポリシーと手順を確立しておく。  
事前に確立しておかない場合、機密情報が権限の無い者に提供されるなど二次災害につながる可能性がある。  
外部とのやり取りはすべて文書化して残すべきである。


##### 2.3.4.1. マスコミ
省略
##### 2.3.4.2. 法執行機関
省略

##### 2.3.4.3. インシデント報告組織

日本では、JPCERT,IPA,監督官庁等が報告組織となる。

##### 2.3.4.4. その他の外部関係者
省略


### 2.4 インシデント対応チームの構成

インシデント対応チームは、組織に関する事件が起きたことを発見した人または疑いを持った人が、だれでも連絡できるようになっておく必要がある。  
事件処理担当者は、事件データを分析し、事件の影響を判断し、組織への影響に歯止めをかけ、適切な活動を行い、サービスを正常な状態に復旧する。

#### 2.4.1. チームのモデル

インシデント対応チームの構成モデル分類

* 中央のインシデント対応チーム
    * インシデント対応専門のチームが組織されている
* 分散したインシデント対応チーム
    * 組織内に複数のインシデント対応チームが存在。
* 調整チーム
    * インシデント対応チームに助言を行う組織

インシデント対応チームの要員配置モデル
* 職員(プロパー)
    * 職員がすべての対応を行い、業者によるサポートは限定的。
* 部分的外部委託
    * 対応作業毎に一部を外部委託する。 
* 完全外部委託
    * インシデント対応を完全に外部業者に委託する。

>部分的外部委託における最も一般的なやり方として  
>侵入検知センサー、ファイアウォール、その他のセキュリティ装置の24時間365日の監視を、MSSP(Managed Security Services Provider:オフサイトの管理セキュリティサービスプロバイダ)に外部委託する方法がある。





